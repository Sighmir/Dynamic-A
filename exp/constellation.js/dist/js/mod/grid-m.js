define(["lib/backbone","lib/underscore","lib/constellation","lib/store"],function(e,t,n,r,i){var s=["addNode","joinNodes","splitNodes","removeNodes","addPolygon","removePolygons","reset"],o=t.extend(new n.Grid,e.Events,{bg:"",init:function(){this.listenTo(this,"change",this.save);var e=this;return t.each(s,function(t){e[t]=function(){n.Grid.prototype[t].apply(e,arguments),e.update()}}),this},setBackground:function(e){this.bg=e,this.save(),this.update()},load:function(){var e=r.get("constellation");this.bg=e&&e.bg||"",this.reset(e)},save:function(e){var t=this.toJSON();t.bg=this.bg,r.set("constellation",t)},update:function(){this.trigger("change")}});return o.init()});